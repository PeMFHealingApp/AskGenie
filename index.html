<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Programs JSON Editor</title>
</head>
<body>

<h1>Programs JSON Editor</h1>

<form id="entryForm" onsubmit="return false;">
  Category:<br>
  <input type="text" id="category" required><br><br>
  Title:<br>
  <input type="text" id="title" required><br><br>
  URL:<br>
  <input type="url" id="url" required><br><br>
  <button type="button" id="addBtn" onclick="addEntry()">Add Entry</button>
</form>

<h2>Entries</h2>
<table border="1" cellpadding="5" id="entriesTable">
  <tr>
    <th>Category</th>
    <th>Title</th>
    <th>URL</th>
    <th>Actions</th>
  </tr>
</table>

<br>
<button onclick="downloadJSON()">Submit All</button>

<script>
let entries = [];
let editIndex = -1;

function addEntry() {
  const category = document.getElementById('category').value.trim();
  const title = document.getElementById('title').value.trim();
  const url = document.getElementById('url').value.trim();

  if (!category || !title || !url) {
    alert("Please fill all fields");
    return;
  }

  if (editIndex === -1) {
    entries.push({ category, title, url });
  } else {
    entries[editIndex] = { category, title, url };
    editIndex = -1;
    document.getElementById('addBtn').textContent = "Add Entry";
  }

  renderTable();
  document.getElementById('entryForm').reset();
}

function renderTable() {
  const table = document.getElementById('entriesTable');
  table.innerHTML = `
    <tr>
      <th>Category</th>
      <th>Title</th>
      <th>URL</th>
      <th>Actions</th>
    </tr>
  `;

  entries.forEach((entry, index) => {
    const row = table.insertRow();
    row.insertCell(0).textContent = entry.category;
    row.insertCell(1).textContent = entry.title;
    row.insertCell(2).textContent = entry.url;
    const actions = row.insertCell(3);

    const editBtn = document.createElement("button");
    editBtn.textContent = "Edit";
    editBtn.onclick = () => editEntry(index);
    actions.appendChild(editBtn);

    const removeBtn = document.createElement("button");
    removeBtn.textContent = "Remove";
    removeBtn.onclick = () => removeEntry(index);
    actions.appendChild(removeBtn);
  });
}

function editEntry(index) {
  const entry = entries[index];
  document.getElementById('category').value = entry.category;
  document.getElementById('title').value = entry.title;
  document.getElementById('url').value = entry.url;
  editIndex = index;
  document.getElementById('addBtn').textContent = "Save Changes";
}

function removeEntry(index) {
  if (confirm("Remove this entry?")) {
    entries.splice(index, 1);
    renderTable();
  }
}

function downloadJSON() {
  const blob = new Blob([JSON.stringify(entries, null, 2)], { type: "application/json" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "programs_cleaned.json";
  a.click();
}
</script>

</body>
</html>
